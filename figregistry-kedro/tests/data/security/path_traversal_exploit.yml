# Path Traversal and Filesystem Security Exploit Test Data
# 
# This file contains malicious configuration vectors designed to test FigureDataSet
# security boundaries and filesystem access controls per Section 6.6.8.2.
# All configurations should be REJECTED by proper security validation.
#
# Test Categories:
# - Directory traversal attacks using ../../../ sequences
# - Absolute path override attempts 
# - Symbolic link exploitation vectors
# - Purpose parameter injection attacks
# - Catalog filepath manipulation
# - Cross-platform path injection variants
# - Filesystem metadata injection attempts
# - Unauthorized directory creation vectors

# =============================================================================
# BASIC PATH TRAVERSAL ATTACKS (Section 6.6.8.2)
# =============================================================================

basic_path_traversal:
  description: "Basic directory traversal using relative path sequences"
  attack_vectors:
    simple_parent_escape:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "../../../etc/passwd.png"
      purpose: "exploratory"
      expected_failure: "Path traversal outside project boundaries"
    
    deep_traversal_attempt:
      type: "figregistry_kedro.datasets.FigureDataSet" 
      filepath: "../../../../../../../../root/malicious.png"
      purpose: "presentation"
      expected_failure: "Deep directory traversal prevention"
    
    mixed_traversal_sequence:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data/08_reporting/../../../bin/exploit.png" 
      purpose: "publication"
      expected_failure: "Mixed path with traversal sequence"

# =============================================================================
# ABSOLUTE PATH OVERRIDE ATTACKS
# =============================================================================

absolute_path_attacks:
  description: "Absolute path injection to bypass directory restrictions"
  attack_vectors:
    unix_root_access:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "/root/secret_figure.png"
      purpose: "exploratory"
      expected_failure: "Absolute Unix path outside project"
    
    windows_system_access:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "C:\\Windows\\System32\\malicious.png"
      purpose: "presentation" 
      expected_failure: "Absolute Windows path to system directory"
    
    windows_drive_traversal:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "D:\\sensitive\\corporate_data.png"
      purpose: "publication"
      expected_failure: "Cross-drive access attempt"
    
    network_path_injection:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "\\\\remote-server\\share\\exploit.png"
      purpose: "exploratory"
      expected_failure: "UNC network path injection"

# =============================================================================
# SYMBOLIC LINK EXPLOITATION VECTORS
# =============================================================================

symlink_attacks:
  description: "Symbolic link based filesystem boundary escape attempts"
  attack_vectors:
    symlink_traversal:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data/08_reporting/symlink_escape.png"
      purpose: "exploratory"
      setup_commands:
        - "ln -s /etc/passwd data/08_reporting/symlink_escape.png"
      expected_failure: "Symlink resolution outside boundaries"
    
    nested_symlink_chain:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data/08_reporting/chain/final.png"
      purpose: "presentation"
      setup_commands:
        - "mkdir -p data/08_reporting/chain"
        - "ln -s ../../../root data/08_reporting/chain/step1"
        - "ln -s step1/secret.png data/08_reporting/chain/final.png"
      expected_failure: "Chained symlink escape detection"
    
    windows_junction_attack:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data\\08_reporting\\junction\\exploit.png"
      purpose: "publication"
      setup_commands:
        - "mklink /J data\\08_reporting\\junction C:\\Windows\\System32"
      expected_failure: "Windows junction point exploitation"

# =============================================================================
# PURPOSE PARAMETER INJECTION ATTACKS  
# =============================================================================

purpose_injection:
  description: "Malicious purpose parameter injection targeting unauthorized access"
  attack_vectors:
    path_injection_via_purpose:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data/08_reporting/normal.png"
      purpose: "../../../etc/passwd"
      expected_failure: "Purpose parameter path injection"
    
    command_injection_purpose:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data/08_reporting/cmd.png" 
      purpose: "; rm -rf / #"
      expected_failure: "Command injection via purpose parameter"
    
    null_byte_injection:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data/08_reporting/null.png"
      purpose: "exploratory\x00../../../secret"
      expected_failure: "Null byte injection in purpose"
    
    unicode_bypass_attempt:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data/08_reporting/unicode.png"
      purpose: "explorator\u0079/../../../escape"
      expected_failure: "Unicode normalization bypass"

# =============================================================================
# CATALOG FILEPATH MANIPULATION ATTACKS
# =============================================================================

catalog_manipulation:
  description: "Catalog parameter manipulation with traversal sequences"
  attack_vectors:
    environment_variable_injection:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "${HOME}/../../../etc/passwd.png"
      purpose: "exploratory"
      expected_failure: "Environment variable path traversal"
    
    parameter_substitution_attack:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "${base_path}/../../../root/exploit.png"
      purpose: "presentation"
      condition_param: "../../../injection"
      expected_failure: "Parameter substitution with traversal"
    
    template_injection:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data/08_reporting/{condition}/../../../escape.png"
      purpose: "publication"
      condition_param: "normal_param"
      expected_failure: "Template string injection"
    
    nested_variable_expansion:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "${${malicious_var}}/exploit.png"
      purpose: "exploratory"
      expected_failure: "Nested variable expansion attack"

# =============================================================================
# CROSS-PLATFORM PATH INJECTION VARIANTS
# =============================================================================

cross_platform_attacks:
  description: "Platform-specific path injection techniques"
  attack_vectors:
    windows_alt_separator:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data\\08_reporting\\..\\..\\..\\Windows\\exploit.png"
      purpose: "exploratory"
      expected_failure: "Windows backslash traversal"
    
    mixed_separator_confusion:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data/08_reporting\\../../../etc/passwd.png"
      purpose: "presentation"
      expected_failure: "Mixed path separator confusion"
    
    double_slash_bypass:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data//08_reporting//..//..//..//etc//passwd.png"
      purpose: "publication"
      expected_failure: "Double slash path normalization bypass"
    
    url_encoded_traversal:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data%2F08_reporting%2F..%2F..%2F..%2Fetc%2Fpasswd.png"
      purpose: "exploratory"
      expected_failure: "URL encoded path traversal"
    
    unicode_path_attack:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data\u002F08_reporting\u002F..\u002F..\u002F..\u002Fetc\u002Fpasswd.png"
      purpose: "presentation"
      expected_failure: "Unicode encoded path traversal"

# =============================================================================
# FILESYSTEM METADATA INJECTION ATTACKS
# =============================================================================

metadata_injection:
  description: "Filesystem metadata manipulation and system path attacks"
  attack_vectors:
    device_file_access:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "/dev/null.png"
      purpose: "exploratory"
      expected_failure: "Device file access attempt"
    
    proc_filesystem_access:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "/proc/self/environ.png"
      purpose: "presentation"
      expected_failure: "Process filesystem access"
    
    windows_special_names:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "CON.png"
      purpose: "publication"
      expected_failure: "Windows reserved device name"
    
    alternate_data_streams:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data\\08_reporting\\normal.png:hidden_stream.txt"
      purpose: "exploratory"
      expected_failure: "NTFS alternate data stream injection"
    
    long_filename_attack:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data/08_reporting/${'A' * 1000}.png"
      purpose: "presentation"
      expected_failure: "Extremely long filename buffer overflow"

# =============================================================================
# UNAUTHORIZED DIRECTORY CREATION ATTACKS
# =============================================================================

directory_creation_attacks:
  description: "Unauthorized directory creation and permission escalation vectors"
  attack_vectors:
    system_directory_creation:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "/usr/local/bin/malicious_tool.png"
      purpose: "exploratory"
      expected_failure: "System directory creation attempt"
    
    hidden_directory_creation:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: ".hidden_backdoor/exploit.png"
      purpose: "presentation"
      expected_failure: "Hidden directory creation in project root"
    
    permission_escalation_attempt:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data/08_reporting/../../../tmp/setuid_exploit.png"
      purpose: "publication"
      style_params:
        file_mode: "0o4755"  # Setuid bit attempt
      expected_failure: "Permission escalation via file mode"
    
    world_writable_creation:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "/tmp/world_writable_exploit.png"
      purpose: "exploratory"
      format_kwargs:
        permissions: "0o777"
      expected_failure: "World-writable file creation"

# =============================================================================
# STYLE PARAMETERS INJECTION ATTACKS
# =============================================================================

style_injection_attacks:
  description: "Malicious injection through style parameters and configuration"
  attack_vectors:
    rcparam_injection:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data/08_reporting/rcparam.png"
      purpose: "exploratory"
      style_params:
        "savefig.directory": "../../../etc"
        "savefig.format": "../../passwd"
      expected_failure: "rcParams path injection"
    
    command_injection_via_style:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data/08_reporting/cmd_style.png"
      purpose: "presentation"
      style_params:
        "figure.titlesize": "; rm -rf / #"
        "font.family": "$(malicious_command)"
      expected_failure: "Command injection via style parameters"
    
    format_kwargs_injection:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data/08_reporting/format.png"
      purpose: "publication"
      format_kwargs:
        fname: "../../../etc/passwd"
        format: "../../escape"
        dpi: "$(malicious_script)"
      expected_failure: "Format arguments injection"

# =============================================================================
# CONDITION PARAMETER MANIPULATION
# =============================================================================

condition_manipulation:
  description: "Condition parameter exploitation for filesystem access"
  attack_vectors:
    condition_path_injection:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data/08_reporting/condition.png"
      purpose: "exploratory"
      condition_param: "../../../etc/passwd"
      expected_failure: "Condition parameter path injection"
    
    condition_command_injection:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data/08_reporting/condition_cmd.png"
      purpose: "presentation"
      condition_param: "; cat /etc/passwd #"
      expected_failure: "Command injection via condition parameter"
    
    condition_import_injection:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data/08_reporting/import.png"
      purpose: "publication"
      condition_param: "__import__('os').system('malicious_command')"
      expected_failure: "Python import injection via condition"

# =============================================================================
# VERSIONING SYSTEM EXPLOITATION
# =============================================================================

versioning_attacks:
  description: "Kedro versioning system exploitation attempts"
  attack_vectors:
    version_path_injection:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data/08_reporting/versioned.png"
      purpose: "exploratory"
      versioned: true
      save_version: "../../../etc/passwd"
      expected_failure: "Version parameter path injection"
    
    load_version_traversal:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data/08_reporting/load_version.png"
      purpose: "presentation" 
      versioned: true
      load_version: "../../../../root/secret"
      expected_failure: "Load version path traversal"
    
    version_metadata_injection:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data/08_reporting/meta.png"
      purpose: "publication"
      versioned: true
      metadata:
        malicious_path: "../../../etc/passwd"
        command_injection: "; rm -rf / #"
      expected_failure: "Metadata field injection"

# =============================================================================
# COMPLEX ATTACK CHAINS  
# =============================================================================

attack_chains:
  description: "Multi-vector attack combinations for comprehensive testing"
  attack_vectors:
    full_spectrum_attack:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "${HOME}/../../../etc/passwd.png"
      purpose: "; cat /etc/shadow #"
      condition_param: "__import__('os').system('malicious')"
      style_params:
        "savefig.directory": "../../../root"
        "figure.titlesize": "$(evil_command)"
      format_kwargs:
        fname: "../../../../sensitive_data"
        metadata:
          injection: "; rm -rf / #"
      versioned: true
      save_version: "../../../system_override"
      expected_failure: "Multi-vector comprehensive attack"
    
    encoding_bypass_chain:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data%2F08_reporting%2F..%2F..%2F..%2Fetc%2Fpasswd.png"
      purpose: "explorator\u0079\x00../../../escape"
      condition_param: "\u002E\u002E\u002F\u002E\u002E\u002F\u002E\u002E\u002Froot"
      expected_failure: "Multiple encoding bypass attempt"
    
    platform_agnostic_attack:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data/08_reporting\\..\\..\\..\\etc\\passwd.png"
      purpose: "C:\\Windows\\System32\\exploit"
      condition_param: "/proc/self/environ"
      style_params:
        path_unix: "../../../etc/passwd"
        path_windows: "..\\..\\..\\Windows\\System32"
        path_network: "\\\\remote\\share\\exploit"
      expected_failure: "Cross-platform attack vector"

# =============================================================================
# EDGE CASE EXPLOITATION
# =============================================================================

edge_case_attacks:
  description: "Edge cases and boundary condition exploits"
  attack_vectors:
    empty_string_injection:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: ""
      purpose: ""
      condition_param: ""
      expected_failure: "Empty string parameter validation"
    
    whitespace_only_paths:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "   "
      purpose: "\t\n\r"
      condition_param: "    "
      expected_failure: "Whitespace-only parameter validation"
    
    null_character_injection:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data/08_reporting/file\x00../../etc/passwd.png"
      purpose: "exploratory\x00../escape"
      expected_failure: "Null character injection prevention"
    
    control_character_injection:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "data/08_reporting/\x1b[31mmalicious\x1b[0m.png"
      purpose: "\x0a\x0d\x1b../../../etc/passwd"
      expected_failure: "Control character injection prevention"
    
    extremely_deep_traversal:
      type: "figregistry_kedro.datasets.FigureDataSet"
      filepath: "${'../' * 100}etc/passwd.png"
      purpose: "exploratory"
      expected_failure: "Extremely deep traversal prevention"

# =============================================================================
# SECURITY VALIDATION METADATA
# =============================================================================

security_test_metadata:
  description: "Metadata for security test validation framework"
  validation_requirements:
    - "All configurations must trigger FigureDatasetError exceptions"
    - "No configuration should allow filesystem access outside project boundaries"
    - "Path validation must occur before any file system operations"
    - "Error messages should not leak sensitive path information"
    - "All attack vectors must be logged for security audit trails"
  
  expected_security_controls:
    - "Path normalization with traversal sequence detection"
    - "Absolute path rejection for non-project locations"
    - "Symlink resolution with boundary enforcement"
    - "Parameter sanitization across all input vectors"
    - "Filesystem permission validation before operations"
    - "Cross-platform path injection prevention"
  
  test_execution_notes:
    - "Tests should run in isolated environments with no actual filesystem modifications"
    - "All malicious configurations designed to fail validation, not execute"
    - "Security test suite validates prevention, not exploitation"
    - "Cross-platform testing required for Windows/Unix variants"
    - "Performance impact of security controls should be measured"

# =============================================================================
# TEST EXECUTION FRAMEWORK INTEGRATION
# =============================================================================

framework_integration:
  description: "Integration points with pytest security testing framework"
  test_categories:
    path_traversal_prevention:
      test_files: ["test_security_path_traversal.py"]
      fixtures: ["malicious_catalog_configs", "filesystem_boundary_validator"]
      markers: ["security", "path_traversal", "filesystem"]
    
    parameter_injection_prevention:
      test_files: ["test_security_injection.py"] 
      fixtures: ["injection_attack_vectors", "parameter_sanitizer_validator"]
      markers: ["security", "injection", "parameter_validation"]
    
    filesystem_boundary_enforcement:
      test_files: ["test_security_filesystem.py"]
      fixtures: ["filesystem_attack_scenarios", "boundary_enforcement_validator"]
      markers: ["security", "filesystem", "boundary_enforcement"]
  
  security_test_execution:
    pytest_command: "pytest -m security tests/data/security/ -v --tb=short"
    coverage_requirement: "100% for all security validation paths"
    performance_impact: "Security controls overhead must be <10ms per validation"
    cross_platform_validation: "Required for Windows, macOS, Linux environments"